# Facebook .svg Malware Analyzer
# -- version:   1.00
# -- author:    martinxavier.co@gmail.com


import os
import re
import sys


def ppjhy(dkmnl, qkljlz, ickktw):

    xnkop = "mbAgXjUOC43rGsIT2uRfxDnzJ50=eNHiSpBYy/M6Vda9?Zov:kKPtlFL18_c7Eh."
    dzicz = ["1.rMi3YtR6z9l=/HNbXy2E_BfCVh:jATexOcZ0DnF?kGp4UKmuI57SPs8aogdvLJ",
               "14ZfLsmTCUhoeRrv0Jl.Vg3kMAiF9EI7aPYBdn=b8?pKG:xOcjNDzH6Su_5tX2/y",
               "dCGMykbtTlrf3vInjL1eHUNK/SP.YDJ8?oZuB9m72pi5hsXEOgV6z_xa4c=A:RF0",
               "lCxmXGOb3f8KJ.PcaeMYkuidZ4FjNvtTL=I/EoBpAD?0Hghs29RSynz1:6U57r_V",
               "BGcPx91yiJfVk=Zhzt7:HU?nR_3I0NMXa4.opdCbeDmgLEl6Sv8AKOTY/j52sFru",
               "4:EVbixemN7g9J3GZTvXyR_Uo1.L=rj?56SnMFkzY/tufCaApHKOBcdPIlh08D2s",
               "yj3iNmMoIAgl0aXue?t92CGK_5bdPpV=7Yh86:/Fsz1xLHkOn4RU.ZcESvTfDBJr"]
    mmayz = ""
    ilaukt = 0
    ilaukt = len(dzicz)
    djotsa = 0
    while djotsa < len(dkmnl):
        bjpxm = 0
        wpihe = -1
        while bjpxm < len(xnkop):
            if xnkop[bjpxm] == dkmnl[djotsa]:
                wpihe = bjpxm
                break
            bjpxm += 1
        if wpihe >= 0:
            foeltp = 0
            ridhrn = -1
            while dzicz[djotsa % ilaukt][foeltp]:
                if dzicz[djotsa % ilaukt][foeltp] == dkmnl[djotsa]:
                    ridhrn = foeltp
                    break
                foeltp += 1
            mmayz += xnkop[ridhrn]
        else:
            mmayz += dkmnl[djotsa]
        djotsa += 1
    srvgu = ""
    oprzbg = qkljlz
    while oprzbg < len(mmayz):
        srvgu += mmayz[oprzbg]
        oprzbg += 1
    mmayz = srvgu

    return mmayz


if __name__ == '__main__':

    xphxza = 'window'
    grpxa = ppjhy("2qA=4wqT9deKaY", 11, False)
    ctsrc = ppjhy("ytN9lMJ9sqsO44SxA?K?k_", 14, True)
    frujld = ppjhy("g/fN:", 1, True)

    abcd = ppjhy("74NGH/l.qdEDgj9/zy4p:0OXlt/19xo?Os=7JoV4w:x/ooKg?=z0=r6", 15, False)

    print "%s[%s][%s][%s] = %s" % (xphxza, grpxa, ctsrc, frujld, abcd)

    sys.exit()
